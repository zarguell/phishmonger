---
phase: 01-editor-foundation
plan: 04
type: execute
wave: 4
depends_on: ["01-03"]
files_modified: []
autonomous: false
user_setup: []

must_haves:
  truths:
    - "User can type text in the editor"
    - "User can format text (bold, italic, links)"
    - "User can select text and wrap it in a Lure Mark with yellow highlight"
    - "User can paste HTML content (tables, styling)"
    - "Pasted content preserves layout but strips scripts and events"
  artifacts: []
  key_links: []
---

<objective>
Verify that the editor works correctly: typing, formatting, Lure Marks, and safe HTML paste.

Purpose: This is the final verification that Phase 1 requirements are met. The user will test all features manually to confirm everything works as expected.

Output: Confirmed working editor with Lure Marks and sanitization
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/01-editor-foundation/01-01-SUMMARY.md
@.planning/phases/01-editor-foundation/01-02-SUMMARY.md
@.planning/phases/01-editor-foundation/01-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete editor implementation:
    - React + Vite + TypeScript project
    - Tiptap editor with Lure Mark extension
    - DOMPurify HTML sanitization
    - Toolbar with Bold, Italic, Link, Mark Lure buttons
    - Yellow highlight styling for Lure Marks
  </what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Visit http://localhost:5173
    3. Test typing: Click in editor and type "This is a phishing email"
    4. Test bold: Select "phishing" and click Bold button - verify text is bold
    5. Test italic: Select "email" and click Italic button - verify text is italic
    6. Test link: Select "This" and click Link button, enter https://example.com - verify link is created
    7. Test Lure Mark: Select "phishing email" and click "Mark Lure" button - verify yellow highlight appears
    8. Inspect HTML: Check preview panel - verify span[data-lure-id] attribute exists (unique UUID)
    9. Test paste: Copy this HTML and paste into editor:
       ```html
       <table style="border: 1px solid black;">
         <tr><td style="background: yellow;">Test</td></tr>
       </table>
       <script>alert('XSS')</script>
       <p onclick="alert('click')">Click me</p>
       ```
       Expected:
       - Table is rendered (preserved layout)
       - Style attribute is preserved
       - Script tag is stripped (no alert)
       - onclick attribute is stripped (clicking text does nothing)
  </how-to-verify>
  <resume-signal>
    Type "approved" if all tests pass, or describe any issues encountered.
  </resume-signal>
</task>

</tasks>

<verification>
Manual verification by user following the steps above.
</verification>

<success_criteria>
- Typing works in the editor
- Bold, Italic, and Link buttons work correctly
- Mark Lure button creates yellow highlight with unique UUID
- Pasted HTML preserves tables and inline styles
- Pasted HTML strips scripts and onclick events
- All Phase 1 requirements are met
</success_criteria>

<output>
After completion, create `.planning/phases/01-editor-foundation/01-04-SUMMARY.md`
</output>
