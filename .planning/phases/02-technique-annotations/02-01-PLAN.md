---
phase: 02-technique-annotations
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/data/techniques.json, src/data/persuasion.json, src/types/annotations.ts]
autonomous: true
user_setup: []


must_haves:
  truths:
    - "Static technique library JSON contains 12 MITRE ATT&CK techniques"
    - "Static persuasion library JSON contains 7 Cialdini/psychological principles"
    - "Annotation type defines lureId, techniqueName, mitreAttackId, persuasionPrincipleId, explanation fields"
    - "Technique library includes T1566.001 through T1204.002 from MITRE ATT&CK"
  artifacts:
    - path: "src/data/techniques.json"
      provides: "Static library of 12 common phishing techniques"
      min_lines: 50
      contains: "T1566.001"
    - path: "src/data/persuasion.json"
      provides: "Static library of 7 psychological persuasion principles"
      min_lines: 20
      contains: "Authority"
    - path: "src/types/annotations.ts"
      provides: "TypeScript type definitions for annotation data structures"
      exports: ["Annotation", "PersuasionPrinciple"]
  key_links:
    - from: "src/types/annotations.ts"
      to: "src/data/techniques.json"
      via: "Type annotations reference technique structure"
      pattern: "interface Annotation"
---


<objective>
Create the data foundation for technique annotations: a static JSON library of 12 common phishing techniques (MITRE ATT&CK) and 7 persuasion principles (Cialdini/Psychology), along with TypeScript types defining the extended annotation data structure.


Purpose: Establish type-safe data structures that components can import to model both technical and psychological aspects of a phish.
Output: technique library JSON, persuasion library JSON, and annotation type definitions.
</objective>


<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>


<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-technique-annotations/02-RESEARCH.md
@.planning/phases/01-editor-foundation/01-07-SUMMARY.md
</context>


<tasks>


<task type="auto">
  <name>Task 1: Create static technique library JSON</name>
  <files>src/data/techniques.json</files>
  <action>
    Create `src/data/techniques.json` with 12 common phishing techniques from MITRE ATT&CK. Focus on **observable email artifacts** (Defense Evasion & Initial Access) rather than post-compromise behavior.


    Use this structure for each technique:
    ```json
    {
      "id": "T1566.001",
      "name": "Spearphishing Attachment",
      "tactic": "Initial Access",
      "description": "Adversaries send spearphishing emails with malicious attachments to gain access.",
      "url": "https://attack.mitre.org/techniques/T1566/001/"
    }
    ```


    Include these 12 techniques:


    **The Payload (The "Hook")**
    1.  **T1566.001** - Spearphishing Attachment (The malicious file)
    2.  **T1566.002** - Spearphishing Link (The malicious link)
    3.  **T1566.003** - Spearphishing via Service (Links to legitimate services like SharePoint/Teams/Google Drive)
    4.  **T1566.004** - Spearphishing Voice (Vishing / "Call this number" lures)
    5.  **T1598** - Phishing for Information (BEC / "Are you available?" reply-based lures)


    **The Identity (The "Mask")**
    6.  **T1036.005** - Masquerading: Match Legitimate Name or Location (Spoofed Display Names or Lookalike Domains)
    7.  **T1078.004** - Valid Accounts: Cloud Accounts (Sent from legitimate `onmicrosoft.com` or `gmail.com` infrastructure)
    8.  **T1586.002** - Compromised Accounts: Email Accounts (Sent from a hacked vendor/colleague - Supply Chain)


    **The Evasion (The "Tricks")**
    9.  **T1027** - Obfuscated Files or Information (Hidden text, zero-width spaces, or white-on-white text)
    10. **T1001.003** - Data Obfuscation: Protocol Impersonation (Fake System Notifications / "Quarantine" alerts)


    **The User Action (The "Goal")**
    11. **T1204.001** - User Execution: Malicious Link (The specific button the user is urged to click)
    12. **T1204.002** - User Execution: Malicious File (The specific file the user is urged to open)


    Use proper JSON formatting (no trailing commas, double quotes).
  </action>
  <verify>
    File exists at src/data/techniques.json with 12 techniques, each with id, name, tactic, description, and url fields. Validate with `node -e "JSON.parse(require('fs').readFileSync('src/data/techniques.json'))"`
  </verify>
  <done>
    Static technique library JSON file created with 12 MITRE ATT&CK techniques ready for import.
  </done>
</task>


<task type="auto">
  <name>Task 2: Create persuasion principles library JSON</name>
  <files>src/data/persuasion.json</files>
  <action>
    Create `src/data/persuasion.json` with 7 psychological/persuasion principles used in phishing.


    Use this structure:
    ```json
    {
      "id": "CIAL-01",
      "name": "Authority",
      "description": "The attacker impersonates an executive, IT Support, or law enforcement to force compliance."
    }
    ```


    Include these 7 principles:
    1.  **Authority** ("CEO Request," "IRS Notification")
    2.  **Urgency / Scarcity** ("Account Deletion in 24h," "Last Chance")
    3.  **Social Proof / Consensus** ("Everyone else has signed this," "Join your team")
    4.  **Liking / Similarity** ("Happy Holidays from your friends at HR," shared interests)
    5.  **Reciprocity** ("We fixed your account, please confirm," "Here is a refund")
    6.  **Consistency / Commitment** ("As we discussed," referencing a fake prior thread)
    7.  **Fear / Curiosity** (e.g., "Legal Action Pending" or "See who viewed your profile")


    Use proper JSON formatting.
  </action>
  <verify>
    File exists at src/data/persuasion.json with 7 items. Validate with `node -e "JSON.parse(require('fs').readFileSync('src/data/persuasion.json'))"`
  </verify>
  <done>
    Static persuasion library JSON file created with 7 psychological principles ready for import.
  </done>
</task>


<task type="auto">
  <name>Task 3: Create annotation TypeScript types</name>
  <files>src/types/annotations.ts</files>
  <action>
    Create src/types/annotations.ts defining the Annotation interface.


    Export these interfaces:
    ```typescript
    export interface Annotation {
      lureId: string                 // Matches data-lure-id attribute in HTML
      techniqueId: string            // MITRE ATT&CK ID (e.g., "T1566.001")
      persuasionPrincipleId?: string // Optional ID from persuasion.json (e.g., "CIAL-02")
      explanation: string            // User-written explanation
      createdAt: string              // ISO timestamp
    }
    ```


    Also export types for the reference libraries:
    ```typescript
    export interface Technique {
      id: string
      name: string
      tactic: string
      description: string
      url: string
    }


    export interface PersuasionPrinciple {
      id: string
      name: string
      description: string
    }
    ```


    Follow TypeScript best practices: use explicit string types, export interfaces for reuse in components.
  </action>
  <verify>
    TypeScript compilation succeeds: `npx tsc --noEmit`. Check for type errors in src/types/annotations.ts.
  </verify>
  <done>
    Annotation, Technique, and PersuasionPrinciple types defined and exported for use throughout the application.
  </done>
</task>


</tasks>


<verification>
- techniques.json contains exactly 12 techniques with valid MITRE ATT&CK IDs
- persuasion.json contains exactly 7 principles
- JSON files validate without syntax errors
- Annotation type has all required fields (lureId, techniqueId, persuasionPrincipleId, explanation)
- TypeScript compilation passes
</verification>


<success_criteria>
Static data foundation exists and is type-safe. Components can now import techniques, persuasion principles, and Annotation types to model the "what" and "why" of a phish.
</success_criteria>


<output>
After completion, create `.planning/phases/02-technique-annotations/02-01-SUMMARY.md`
</output>
