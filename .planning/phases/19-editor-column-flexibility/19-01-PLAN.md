---
phase: 19-editor-column-flexibility
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/columns.ts
  - src/utils/storage.ts
  - src/App.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can click expand button in column header to focus that column (full-width)"
    - "Expand button appears in all 4 column headers (input, preview, lure-list, scoring)"
    - "Clicking expand button on already-focused column resets to normal view"
    - "Column type definitions exist for TypeScript type safety"
    - "Column header buttons are visible and clickable"
  artifacts:
    - path: "src/types/columns.ts"
      provides: "ColumnID type definition"
      contains: "export type ColumnID = 'input' | 'preview' | 'lure-list' | 'scoring'"
    - path: "src/utils/storage.ts"
      provides: "loadFocusedColumn(), saveFocusedColumn() functions"
      exports: ["loadFocusedColumn", "saveFocusedColumn"]
    - path: "src/App.tsx"
      provides: "Column focus management with focusedColumn state and toggleColumnFocus function"
      contains: "useState<ColumnID | null>"
  key_links:
    - from: "src/App.tsx"
      to: "src/utils/storage.ts"
      via: "import { loadFocusedColumn, saveFocusedColumn }"
      pattern: "import.*loadFocusedColumn.*from.*storage"
    - from: "src/App.tsx"
      to: "src/types/columns.ts"
      via: "import type { ColumnID }"
      pattern: "import type.*ColumnID"
---

<objective>
Create type definition and storage utilities for column focus state, plus implement column header buttons with expand/focus functionality in App.tsx.

Purpose: Establish the foundation for column flexibility by defining the ColumnID type, storage utilities for focus persistence, and UI controls for column focus mode.
Output: Working expand buttons in all 4 column headers that toggle focus mode.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-editor-column-flexibility/19-RESEARCH.md
@src/types/columns.ts
@src/utils/storage.ts
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Create column type definition</name>
  <files>src/types/columns.ts</files>
  <action>
    Create src/types/columns.ts with:

    1. ColumnID union type: 'input' | 'preview' | 'lure-list' | 'scoring'
    2. Export the type

    This is a simple type definition file - no ColumnState or ColumnStates needed
    since we only track focusedColumn (single column focus mode).

    Do NOT create any other files in this task.
  </action>
  <verify>grep -q "export type ColumnID" src/types/columns.ts</verify>
  <done>Type definition file exists with ColumnID export</done>
</task>

<task type="auto">
  <name>Add focused column storage utilities</name>
  <files>src/utils/storage.ts</files>
  <action>
    Add to src/utils/storage.ts (after line 289, before campaign storage section):

    1. FOCUSED_COLUMN_KEY = 'phishmonger-focused-column'
    2. loadFocusedColumn() function that:
       - Reads from localStorage using FOCUSED_COLUMN_KEY
       - Returns null if not found or if value is not a valid ColumnID
       - Returns null on parse error (try-catch with console.error)
    3. saveFocusedColumn(columnId: ColumnID | null) function that:
       - Saves to localStorage using FOCUSED_COLUMN_KEY
       - If columnId is null, removes the item (localStorage.removeItem)
       - Handles QuotaExceededError gracefully (console.error, no throw)

    Follow existing storage.ts pattern (lines 262-289 for loadCompactLayout/saveCompactLayout).
    Import ColumnID type from '../types/columns' at top of file.
  </action>
  <verify>grep -q "FOCUSED_COLUMN_KEY" src/utils/storage.ts && grep -q "loadFocusedColumn" src/utils/storage.ts && grep -q "saveFocusedColumn" src/utils/storage.ts</verify>
  <done>Storage utilities exist and follow Phase 16 error-handling pattern</done>
</task>

<task type="auto">
  <name>Add column focus management and header buttons to App.tsx</name>
  <files>src/App.tsx</files>
  <action>
    Modify src/App.tsx:

    1. Add imports at top (after line 31):
       - import type { ColumnID } from './types/columns'
       - import { loadFocusedColumn, saveFocusedColumn } from './utils/storage'

    2. Add state after line 162 (after arrowStyle state):
       ```typescript
       const [focusedColumn, setFocusedColumn] = useState<ColumnID | null>(() => loadFocusedColumn())
       ```

    3. Add useEffect after line 197 (after showBadge useEffect) to persist focus state:
       ```typescript
       useEffect(() => {
         saveFocusedColumn(focusedColumn)
       }, [focusedColumn])
       ```

    4. Add toggleColumnFocus function after handleViewCarousel (after line 453):
       ```typescript
       const toggleColumnFocus = (columnId: ColumnID) => {
         setFocusedColumn(prev => {
           if (prev === columnId) {
             return null // Reset to normal view
           }
           return columnId // Focus this column
         })
       }
       ```

    5. Add ColumnHeader component inside App (before main return, after line 535):
       ```typescript
       const ColumnHeader = ({ title, columnId, onToggle }: {
         title: string
         columnId: ColumnID
         onToggle: () => void
       }) => (
         <div className="column-header">
           <span className="column-header-title">{title}</span>
           <button
             className="expand-column-btn"
             onClick={onToggle}
             title={focusedColumn === columnId ? "Reset to normal view" : "Expand to full width"}
             type="button"
           >
             {focusedColumn === columnId ? '−' : '+'}
           </button>
         </div>
       )
       ```

    6. Wrap each column content with ColumnHeader:
       - input-column: Add header with "Email Input", onToggle: () => toggleColumnFocus('input')
       - preview-column: Add header with "Preview", onToggle: () => toggleColumnFocus('preview')
       - lure-list-column: Add header with "Annotations", onToggle: () => toggleColumnFocus('lure-list')
       - scoring-column: Add header with "Scoring", onToggle: () => toggleColumnFocus('scoring')

    IMPORTANT: Do NOT add keyboard shortcuts (1,2,3,4) in this plan - that's plan 19-04.
    IMPORTANT: Do NOT add CSS styles - that's handled by plan 19-02.
    NOTE: Simplified from original design - single expand button (+/−) toggles focus mode.
  </action>
  <verify>grep -q "ColumnID" src/App.tsx && grep -q "toggleColumnFocus" src/App.tsx && grep -q "ColumnHeader" src/App.tsx</verify>
  <done>App.tsx has column focus management, toggle function, and ColumnHeader component with expand button for all 4 columns</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: npm run type-check (or npx tsc --noEmit)
2. Column type exists: grep -q "ColumnID" src/types/columns.ts
3. Storage utilities exist: grep -q "loadFocusedColumn" src/utils/storage.ts
4. Column headers render in browser (manual visual check - buttons visible in all 4 columns)
</verification>

<success_criteria>
1. Column type definition file exists with ColumnID export
2. Storage utilities follow Phase 16 error-handling pattern
3. App.tsx manages focusedColumn state with useState and persists via useEffect
4. All 4 columns have expand button (+) in headers
5. Clicking button updates focusedColumn state (visible in React DevTools or localStorage)
</success_criteria>

<output>
After completion, create `.planning/phases/19-editor-column-flexibility/19-01-SUMMARY.md`
</output>
