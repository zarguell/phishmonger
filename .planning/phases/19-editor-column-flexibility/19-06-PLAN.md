---
phase: 19-editor-column-flexibility
plan: 06
type: execute
wave: 2
depends_on:
  - 19-05
files_modified:
  - src/index.css
  - src/App.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Minimized columns collapse to ~40px header bar only"
    - "Minimized columns show header bar with expand button visible"
    - "Column content is hidden when collapsed (overflow: hidden)"
    - "Normal columns unaffected when other columns are minimized"
  artifacts:
    - path: "src/index.css"
      provides: "CSS for collapsed column state"
      contains: ".column-collapsed"
    - path: "src/App.tsx"
      provides: "data-collapsed-column attributes for CSS binding"
      exports: []
  key_links:
    - from: "src/App.tsx"
      to: "CSS .column-collapsed"
      via: "data-collapsed-column attribute on column containers"
      pattern: "data-collapsed-column"
    - from: "src/index.css"
      to: "collapsed column behavior"
      via: "CSS selectors for data-collapsed-column attribute"
      pattern: "\[data-collapsed-column"
---

<objective>
Add CSS styling for collapsed columns that shows only the header bar (~40px) with expand/minimize buttons visible, while hiding column content. CSS responds to data-collapsed-column attributes on column containers.

Purpose: EDIT-04 requires collapsed columns show header bar (not 0 width like focus mode), enabling users to quickly restore minimized columns while maintaining workspace visibility.
Output: CSS for .column-collapsed state, data-collapsed-column attribute bindings on all 4 columns, collapsed header bars visible at ~40px width
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/19-editor-column-flexibility/19-editor-column-flexibility-VERIFICATION.md
@.planning/phases/19-editor-column-flexibility/19-02-SUMMARY.md
@.planning/phases/19-editor-column-flexibility/19-05-SUMMARY.md

# Gap context from VERIFICATION.md
Gap: "Minimized columns collapse to header bar with expand button visible" - FAILED
Reason: "Columns collapse to 0 width (completely hidden), not to header bar with visible button. No collapsed header state exists."

Missing from gap:
- CSS state for collapsed-but-visible columns (showing only header bar)
- Currently grid-template-columns sets non-focused columns to 0 (line 47-62 in index.css)

# Existing CSS from 19-02
Focus mode uses grid-template-columns: 1fr 0 0 0 for input column focus (line 47)
All focus selectors set non-focused columns to 0 width (lines 46-63)
Column headers styled with .column-header (line 218+)

# From 19-05 (prior plan)
- collapsedColumns Set<ColumnID> state added
- Minimize button added to ColumnHeader component
- Need to bind data-collapsed-column attributes to column containers
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS for collapsed column state</name>
  <files>src/index.css</files>
<action>
Add CSS styling for collapsed columns that shows header bar only (~40px) while hiding content:

1. After column header styles (around line 260+), add collapsed column CSS:
```css
/* Collapsed column state - shows header bar only */
.column-collapsed {
  min-width: 40px !important;
  width: 40px !important;
  max-width: 40px !important;
  overflow: hidden;
}

/* Hide column content when collapsed, keep header visible */
.column-collapsed > :not(.column-header) {
  display: none;
}

/* Collapsed column header - vertical text for compact display */
.column-collapsed .column-header {
  width: 40px;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  padding: 8px 4px;
  height: auto;
  justify-content: center;
  gap: 4px;
}

/* Column header actions container (holds minimize + expand buttons) */
.column-header-actions {
  display: flex;
  gap: 4px;
  align-items: center;
}

/* Minimize column button styling */
.minimize-column-btn {
  width: 24px;
  height: 24px;
  padding: 0;
  border: 1px solid #ddd;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  color: #666;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.minimize-column-btn:hover {
  background: #f5f5f5;
  color: #333;
  border-color: #999;
}

/* Adjust column header when NOT collapsed (horizontal layout) */
.column-header:not(.column-collapsed .column-header) {
  writing-mode: horizontal-tb;
}
```

2. Note: The collapsed column uses !important on width properties to override the CSS grid focus-mode widths (0px) from 19-02. This allows a column to be both collapsed (40px) and have focus mode active on another column simultaneously.

Reference existing column header styles from 19-02 (line 218-240) for consistency.
Reference focus mode grid layouts (lines 46-63) - these set columns to 0px, but !important on .column-collapsed overrides for collapsed columns.
  </action>
  <verify>
grep -n "column-collapsed\|minimize-column-btn\|column-header-actions" src/index.css returns CSS definitions
  </verify>
  <done>CSS for collapsed columns shows header bar only at 40px width, content hidden</done>
</task>

<task type="auto">
  <name>Task 2: Bind data-collapsed-column attributes to column containers</name>
  <files>src/App.tsx</files>
  <action>
Add data-collapsed-column attributes to column containers to enable CSS targeting of collapsed columns:

Find the 4 column containers in the JSX (around lines 670-750) and add data-collapsed-column attributes. Look for the column structure that contains ColumnHeader and column content.

For each of the 4 columns (input, preview, lure-list, scoring), add:
```tsx
<div
  data-collapsed={collapsedColumns.has('input') ? 'true' : 'false'}
  className={collapsedColumns.has('input') ? 'column-collapsed' : ''}
>
  {/* Column content */}
</div>
```

Example for input column (find the div containing HTMLInput, around line 670):
```tsx
<div
  className={`editor-column ${collapsedColumns.has('input') ? 'column-collapsed' : ''}`}
  data-collapsed={collapsedColumns.has('input') ? 'true' : 'false'}
>
  <ColumnHeader
    title="HTML Source"
    columnId="input"
    onToggle={() => toggleColumnFocus('input')}
    onMinimize={() => toggleColumnCollapsed('input')}
    isCollapsed={collapsedColumns.has('input')}
  />
  <HTMLInput ... />
</div>
```

Repeat for:
- Preview column (around line 710)
- Lure list/annotations column (around line 720)
- Scoring column (around line 740)

Reference existing ColumnHeader usage from 19-05 (added in Task 2 of 19-05).
The column containers should already have className, just add the conditional class and data attribute.
  </action>
  <verify>
grep -c 'data-collapsed' src/App.tsx returns 4 (one per column)
grep -c 'column-collapsed' src/App.tsx returns 4 (one per column)
  </verify>
  <done>All 4 column containers have data-collapsed attributes bound to collapsedColumns state</done>
</task>

</tasks>

<verification>
TypeScript compilation: npx tsc --noEmit passes without errors

CSS verification:
- .column-collapsed sets width to 40px with !important
- Column content hidden when collapsed (display: none for :not(.column-header))
- Column header visible when collapsed, rotated vertically
- Minimize and expand buttons visible in collapsed header
- .column-header-actions container exists
- .minimize-column-btn styled with hover states

Functional checks:
- Collapsed column shows header bar at ~40px width
- Collapsed column header text is vertical (writing-mode: vertical-rl)
- Minimize button shows ↑ when collapsed (expand action)
- Minimize button shows ↓ when not collapsed (minimize action)
- Both minimize and expand buttons visible in collapsed header
- Column content hidden when collapsed
- Multiple columns can be collapsed simultaneously
- Normal columns unaffected when other columns collapsed
- Collapsed state persists across page refresh
</verification>

<success_criteria>
- Collapsed columns display as 40px header bar with visible buttons
- Column content hidden when collapsed (not just 0 width)
- Vertical text orientation in collapsed headers
- Both minimize and expand buttons visible
- Multiple columns can be collapsed independently
- Normal columns maintain layout when others collapsed
- TypeScript compilation passes
</success_criteria>

<output>
After completion, create `.planning/phases/19-editor-column-flexibility/19-06-SUMMARY.md`
</output>
