---
phase: 17-import-ux-improvements
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/import/PhishImportModal.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - User opens phish import modal from ProjectSettings
    - Modal closes with Escape key or backdrop click
    - User imports phish via file upload
    - User imports phish via text paste
    - Invalid JSON shows inline error message
  artifacts:
    - path: "src/components/import/PhishImportModal.tsx"
      provides: "Phish import modal with file + text input"
      min_lines: 80
      exports: ["PhishImportModal"]
  key_links:
    - from: "src/components/import/PhishImportModal.tsx"
      to: "src/utils/storage.ts"
      via: "importProjectJSON function"
      pattern: "importProjectJSON"
    - from: "src/components/import/PhishImportModal.tsx"
      to: "src/components/shortcuts/KeyboardShortcutHelp.tsx"
      via: "modal pattern (escape key + backdrop click)"
      pattern: "useEffect.*keydown.*Escape"
---

<objective>
Create PhishImportModal component - modal dialog for importing phishes with dual input methods

Purpose: Replace expanding menu pattern in ProjectSettings with a modal dialog that doesn't cause layout shift, supporting both file upload and text paste import methods
Output: New PhishImportModal component with escape key support, backdrop click handling, and JSON validation
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/shortcuts/KeyboardShortcutHelp.tsx
@src/components/ProjectSettings.tsx
@src/utils/storage.ts
@src/types/phish.ts
</context>

<tasks>

<task type="auto">
  <name>Create PhishImportModal component with dual input</name>
  <files>src/components/import/PhishImportModal.tsx</files>
  <action>
Create new modal component at src/components/import/PhishImportModal.tsx:

**Interface:**
```typescript
interface PhishImportModalProps {
  isOpen: boolean;
  onClose: () => void;
  onImport: (project: ProjectJSON) => void;
}
```

**Modal Pattern (copy from KeyboardShortcutHelp.tsx lines 11-29):**
- useEffect for Escape key handling (addEventListener 'keydown', check event.key === 'Escape')
- handleBackdropClick function: check if event.target === event.currentTarget, then call onClose()
- Return null if !isOpen

**Layout (follow KeyboardShortcutHelp modal style):**
- Fixed backdrop with rgba(0, 0, 0, 0.5) background, zIndex 1000
- White content div with borderRadius 8px, boxShadow, maxWidth 500px
- Header with title "Import Phish" and close button (Ã—)
- Tabbed or stacked layout for two input methods:
  1. File upload: hidden file input, styled button to trigger click
  2. Text paste: textarea with placeholder "Paste phish JSON here..."

**Import Logic (reuse ProjectSettings patterns):**
- File handler: FileReader.readAsText, then JSON.parse, validate via importProjectJSON()
- Text handler: Direct JSON.parse, validate via importProjectJSON()
- On success: Call onImport(project), call onClose(), clear all state
- On error: setImportError(message), show inline error below input

**State Management:**
- importError: string | null (for validation failures)
- importText: string (for text paste input)
- fileInputRef: useRef<HTMLInputElement> (for file input)

**IMPORTANT:**
- Reset file input value after processing (fileInputRef.current.value = '')
- Clear all state when modal closes (useEffect on isOpen change)
- Show specific error messages from importProjectJSON (don't swallow errors)
- Disable import button when text is empty or file not selected

Use inline styles (matching KeyboardShortcutHelp pattern), NOT CSS modules or styled-components.
  </action>
  <verify>
Check file exists at src/components/import/PhishImportModal.tsx with:
- Interface PhishImportModalProps defined
- useEffect for Escape key handling present
- handleBackdropClick function present
- File and text input handlers present
- Error state handling present
- Export statement: export function PhishImportModal(...)
  </verify>
  <done>
PhishImportModal component exists with:
- Modal open/close behavior
- Escape key closes modal
- Backdrop click closes modal
- File upload imports valid JSON
- Text paste imports valid JSON
- Invalid JSON shows error message
- All state resets on close
  </done>
</task>

</tasks>

<verification>
- Component compiles without TypeScript errors
- Modal follows KeyboardShortcutHelp pattern (escape key + backdrop click)
- Both file upload and text paste methods work
- JSON validation catches invalid input
- Error messages are user-friendly
</verification>

<success_criteria>
PhishImportModal component created and ready for integration into App.tsx
</success_criteria>

<output>
After completion, create `.planning/phases/17-import-ux-improvements/17-01-SUMMARY.md`
</output>
