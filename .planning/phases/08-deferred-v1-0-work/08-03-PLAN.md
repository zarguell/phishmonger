---
phase: 08-deferred-v1-0-work
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/arrows.module.css
  - src/components/visualizer/ArrowStyleSelector.tsx
  - src/App.tsx
  - src/index.css
autonomous: false

must_haves:
  truths:
    - "User can select from multiple arrow badge styles (Classic Circle, Square, Diamond)"
    - "Selected arrow style applies to all annotation badges in preview"
    - "Diamond style counter-rotates inner number so text stays upright"
    - "Arrow style preference persists in LocalStorage"
  artifacts:
    - path: "src/styles/arrows.module.css"
      provides: "Scoped CSS for arrow badge styles"
      min_lines: 60
    - path: "src/components/visualizer/ArrowStyleSelector.tsx"
      provides: "UI component for selecting arrow style"
      min_lines: 40
  key_links:
    - from: "src/components/visualizer/ArrowStyleSelector.tsx"
      to: "src/styles/arrows.module.css"
      via: "CSS Module import"
      pattern: "import.*arrows.*module"
    - from: "src/App.tsx"
      to: "localStorage"
      via: "Arrow style preference saved to LocalStorage"
      pattern: "localStorage.*arrow.*style"
---

<objective>
Custom arrow badge styles for annotation markers.

Purpose: Users can customize the visual appearance of annotation badges to match their presentation style or organization branding.
Output: Arrow style selector with Classic Circle, Square, and Diamond options, persisted to LocalStorage.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/08-deferred-v1-0-work/08-DEFERRED-V1-0-WORK-RESEARCH.md

# Only reference prior plan SUMMARYs if genuinely needed
@src/components/preview/EmailColumn.tsx
@src/components/preview/AnnotationColumn.tsx
@src/components/annotation/AnnotationCard.tsx
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create arrow styles CSS module</name>
  <files>src/styles/arrows.module.css</files>
  <action>
    Create src/styles/arrows.module.css with arrow badge style variants:

    Define base .arrowBadge class with:
    - Position absolute
    - Width 24px, height 24px
    - Flexbox centering for numbers
    - Bold font, 14px size
    - Smooth transition (0.2s ease)

    Define style variants:
    - .classic: Blue circle (#3b82f6), white text, 2px border (#2563eb)
    - .square: Green (#10b981), rounded corners (4px), 2px border (#059669)
    - .diamond: Orange (#f59e0b), rotated 45deg, 2px border (#d97706)
      - Counter-rotate child span with -45deg to keep text upright (pitfall #4 from research)

    Reference RESEARCH.md lines 201-268 for exact CSS patterns.

    Do NOT use styled-components or CSS-in-JS - CSS Modules are lighter and already in the project.
  </action>
  <verify>test -f src/styles/arrows.module.css && grep -q "arrowBadge" src/styles/arrows.module.css && grep -q "classic\|square\|diamond" src/styles/arrows.module.css</verify>
  <done>arrows.module.css with Classic Circle, Square, and Diamond style variants</done>
</task>

<task type="auto">
  <name>Task 2: Create ArrowStyleSelector component</name>
  <files>src/components/visualizer/ArrowStyleSelector.tsx</files>
  <action>
    Create src/components/visualizer/ArrowStyleSelector.tsx:

    - Props: currentStyle (string), onStyleChange (function)
    - Render three style preview buttons showing each badge variant
    - Each button shows a live preview of the badge style
    - Highlight currently selected style
    - Use the arrows CSS module for styling

    Component structure:
    - Label: "Badge Style"
    - Row of three buttons, each containing a preview badge
    - On click, call onStyleChange with selected style name

    Position this component in the preview mode header, near the annotation width slider.
  </action>
  <verify>test -f src/components/visualizer/ArrowStyleSelector.tsx && grep -q "ArrowStyleSelector" src/components/visualizer/ArrowStyleSelector.tsx</verify>
  <done>ArrowStyleSelector component with live preview of each style variant</done>
</task>

<task type="checkpoint:human-verify">
  <what-built>Complete arrow style customization system (CSS module + selector component + persistence)</what-built>
  <how-to-verify>
    1. Enter Preview Mode
    2. Locate "Badge Style" selector in header
    3. Click each style option (Classic, Square, Diamond)
    4. Verify badges update to match selected style
    5. For Diamond style, verify numbers stay upright (not rotated)
    6. Refresh page - verify selected style persists
    7. Check that all annotation badges use the same style (not mixed)
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues with badge styling or selector behavior</resume-signal>
</task>

</tasks>

<verification>
1. All three arrow styles render correctly
2. Diamond style keeps text upright (counter-rotation working)
3. Style changes apply immediately without page refresh
4. Style preference persists across browser refresh
5. Visual feedback shows which style is currently selected
</verification>

<success_criteria>
- Users can customize annotation badge appearance
- All style variants are visually distinct and professional
- Diamond rotation doesn't break number positioning
- Preference persists across sessions
</success_criteria>

<output>
After completion, create `.planning/phases/08-deferred-v1-0-work/08-03-SUMMARY.md`
</output>
