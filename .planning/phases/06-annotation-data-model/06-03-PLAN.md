---
phase: 06-annotation-data-model
plan: 06-03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/AnnotationCard.tsx
autonomous: true
must_haves:
  truths:
    - "Persuasion tag displays in format '(Persuasion: Urgency)'"
    - "Both MITRE and Persuasion tags can coexist on same annotation"
    - "Tags appear inline on the same line in visualizer card"
  artifacts:
    - path: src/components/AnnotationCard.tsx
      provides: "Combined tag display for MITRE and Persuasion"
      contains: "Persuasion:|CIAL-"
  key_links:
    - from: src/components/AnnotationCard.tsx
      to: src/data/persuasion.json
      via: "persuasionPrincipleId lookup"
      pattern: "persuasion.*find|pinciple.*name"
---

<objective>
Add Persuasion Principle tag display to AnnotationCard, formatted inline with MITRE tag. Both tags appear on same line per ANN-11 and ANN-12.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md

# Persuasion data format (src/data/persuasion.json):
```json
{
  "id": "CIAL-02",
  "name": "Urgency / Scarcity",
  "description": "Time pressure or limited availability..."
}
```

# Tag display formats:
- MITRE: `(T1598 - Phishing for Information)`
- Persuasion: `(Persuasion: Urgency / Scarcity)` or `(Persuasion: Urgency)`

# Visualizer card layout per ANN-12:
```
Line 1: Title (bold)          ← ANN-09
Line 2: Tags inline           ← ANN-10, ANN-11
Line 3: Full description      ← existing
```

Tags on same line, separated by space.
</context>

<tasks>

<task type="auto">
  <name>Add Persuasion tag display to AnnotationCard</name>
  <files>src/components/AnnotationCard.tsx</files>
  <action>
    Edit src/components/AnnotationCard.tsx to add Persuasion tag display.
    
    First, import persuasion principles:
    ```typescript
    import persuasionPrinciples from '../data/persuasion.json'
    ```
    
    Add helper function for persuasion name lookup:
    ```typescript
    function getPersuasionName(id: string): string {
      const principle = persuasionPrinciples.find(p => p.id === id)
      return principle?.name || id
    }
    ```
    
    Update the tags section to include both MITRE and Persuasion:
    ```typescript
    <div className="annotation-tags">
      {annotation.techniqueId && (
        <span className="mitre-tag">
          ({getTechniqueName(annotation.techniqueId)})
        </span>
      )}
      {annotation.persuasionPrincipleId && (
        <span className="persuasion-tag">
          (Persuasion: {getPersuasionName(annotation.persuasionPrincipleId)})
        </span>
      )}
    </div>
    ```
    
    Tags will appear inline on the same line with CSS spacing.
  </action>
  <verify>grep -n "Persuasion:\|persuasion-tag" src/components/AnnotationCard.tsx</verify>
  <done>AnnotationCard displays Persuasion tag inline</done>
</task>

<task type="auto">
  <name>Add CSS for tag styling</name>
  <files>src/index.css</files>
  <action>
    Add CSS styles for the new annotation card and tags in src/index.css.
    
    ```css
    .annotation-card {
      padding: 12px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
    }
    
    .annotation-title {
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 1.1em;
    }
    
    .annotation-tags {
      display: inline;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .mitre-tag,
    .persuasion-tag {
      display: inline;
      font-size: 0.85em;
      color: #495057;
      background: #e9ecef;
      padding: 2px 6px;
      border-radius: 3px;
      margin-right: 8px;
    }
    
    .annotation-description {
      white-space: pre-wrap;
    }
    ```
  </action>
  <verify>grep -n "\.annotation-tags\|\.persuasion-tag" src/index.css</verify>
  <done>CSS styles added for annotation card and tags</done>
</task>

<task type="auto">
  <name>Verify tag display with both MITRE and Persuasion present</name>
  <files>src/components/AnnotationCard.tsx</files>
  <action>
    Read src/components/AnnotationCard.tsx to verify complete implementation.
    
    The card should handle all combinations:
    - Title + MITRE + Persuasion + Description
    - Title + MITRE only + Description
    - Title + Persuasion only + Description
    - Title + Description only (no tags)
    - No title + MITRE + Persuasion + Description
    
    Each field should be conditionally rendered with &&
  </action>
  <verify>grep -n "annotation\.techniqueId\|annotation\.persuasionPrincipleId\|annotation\.title" src/components/AnnotationCard.tsx</verify>
  <done>All annotation fields conditionally rendered</done>
</task>

</tasks>

<verification>
# Phase 6 Plan 3 Verification

Run these commands to verify:

1. Persuasion tag in AnnotationCard:
```bash
grep -n "Persuasion:" src/components/AnnotationCard.tsx
# Should find Persuasion tag display
```

2. Both tag types render:
```bash
grep -n "mitre-tag\|persuasion-tag" src/components/AnnotationCard.tsx
# Should find both tag types
```

3. CSS for tags:
```bash
grep -n "\.annotation-tags\|\.persuasion-tag" src/index.css
# Should find tag styles
```

4. Build passes:
```bash
npm run build 2>&1 | head -20
```
</verification>

<success_criteria>
- [ ] AnnotationCard displays Persuasion tag as "(Persuasion: Urgency)"
- [ ] Both MITRE and Persuasion tags can coexist on same annotation
- [ ] Tags appear inline on same line
- [ ] CSS styles applied for visual consistency
- [ ] All combinations of optional fields render correctly
- [ ] Build passes with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-annotation-data-model/06-03-SUMMARY.md`
</output>
