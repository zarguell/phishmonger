---
phase: 15-dependency-upgrades-polish
plan: 05
type: execute
wave: 5
depends_on: [15-04]
files_modified:
  - src/**/*.tsx
  - src/**/*.ts
  - vite.config.ts
autonomous: false

must_haves:
  truths:
    - "Any breaking changes from upgrades are fixed"
    - "Any deprecation warnings are fixed or documented with suppression comments"
    - "Production build has zero warnings"
    - "All features from smoke test still work after fixes"
  artifacts:
    - path: "src/**/*.ts"
      provides: "Fixed source code"
      contains: "updated patterns for upgraded dependencies"
  key_links:
    - from: "console warnings"
      to: "source fixes"
      via: "breaking change resolution"
      pattern: "console.(warn|error)"
---

<objective>
Fix any breaking changes or deprecation warnings discovered during smoke testing.

Purpose: This is a conditional plan - tasks are executed only if smoke testing reveals issues. The goal is to address any remaining problems before marking the upgrade complete.
Output: Clean application with no console errors or warnings.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/15-dependency-upgrades-polish/15-RESEARCH.md
@.planning/phases/15-dependency-upgrades-polish/15-CONTEXT.md
@.planning/phases/15-dependency-upgrades-polish/15-04-SUMMARY.md
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/**/*.ts
@src/**/*.tsx
</context>

<tasks>

<task type="checkpoint:decision" gate="blocking">
  <decision>Did smoke testing in 15-04 reveal any issues that need fixing?</decision>
  <context>
    Plan 15-04 performs comprehensive smoke testing. This task is conditional - only execute if issues were found during that testing.

    If 15-04 passed with no issues, this entire plan can be marked as "no fixes needed" and skipped.
  </context>
  <options>
    <option id="no-issues">
      <name>No fixes needed</name>
      <pros>Smoke test passed cleanly, all features work</pros>
      <cons>None - this is the ideal outcome</cons>
    </option>
    <option id="fix-breaking">
      <name>Fix breaking changes</name>
      <pros>Resolves any functional issues from upgrades</pros>
      <cons>Requires code changes and re-testing</cons>
    </option>
    <option id="fix-warnings">
      <name>Fix deprecation warnings</name>
      <pros>Eliminates console warnings for cleaner output</pros>
      <cons>May require significant refactoring depending on warning</cons>
    </option>
  </options>
  <resume-signal>Select: no-issues, fix-breaking, fix-warnings, or describe specific issues found</resume-signal>
</task>

<task type="auto" depends_on="fix-breaking">
  <name>Fix breaking changes from dependency upgrades</name>
  <files>src/**/*.tsx, src/**/*.ts</files>
  <action>
    For each breaking change found during smoke testing:

    1. Identify the problematic API/pattern from the error
    2. Research the correct migration pattern for the upgraded dependency
    3. Update the code to use the new pattern
    4. Test the fix locally

    Common breaking changes to watch for:
    - Tiptap v3: Extension API changes (already addressed in LureMark)
    - React 19: Stricter null checking on refs
    - Build tools: Changes to import resolution or plugin options

    Document each fix in a code comment explaining what changed and why.
  </action>
  <verify>npx tsc --noEmit && npm run build && echo "Build successful"</verify>
  <done>Breaking changes fixed, build succeeds</done>
</task>

<task type="auto" depends_on="fix-warnings">
  <name>Fix or suppress deprecation warnings</name>
  <files>src/**/*.tsx, src/**/*.ts, vite.config.ts</files>
  <action>
    For each deprecation warning found:

    **Approach 1: Fix the warning (preferred)**
    - Update to the recommended new API/pattern
    - Test that functionality still works

    **Approach 2: Suppress with documentation (if fix is complex/non-critical)**
    - Add // eslint-disable-next-line or @ts-ignore with explanation
    - Comment must explain: why suppressing, what the warning is, when to revisit

    Example suppression comment:
    ```typescript
    // eslint-disable-next-line deprecation/deprecation
    // TODO: Upgrade to XYZ API when ABC component is refactored (tracked in issue #123)
    someDeprecatedMethod()
    ```

    Prefer fixing over suppressing. Only suppress if the fix is disproportionately complex relative to the warning's severity.
  </action>
  <verify>npm run build 2>&1 | grep -i warning || echo "No warnings found"</verify>
  <done>Warnings fixed or documented with suppression comments</done>
</task>

<task type="checkpoint:human-verify" depends_on="fix-breaking,fix-warnings">
  <what-built>Fixes applied to address breaking changes and deprecation warnings</what-built>
  <how-to-verify>
    1. Run production build: npm run build
    2. Check build output for errors or warnings
    3. Start preview server: npm run preview
    4. Open http://localhost:4173
    5. Check browser console (F12) - should be zero errors/warnings
    6. Re-test the specific workflow(s) that were broken
    7. Verify the fixes work correctly

    Expected: Build succeeds with zero warnings, fixed workflows work correctly.
  </how-to-verify>
  <resume-signal>Type "approved" if fixes work correctly, or describe remaining issues</resume-signal>
</task>

</tasks>

<verification>
If fixes were needed:
1. Breaking changes are fixed and workflows work correctly
2. Deprecation warnings are fixed or documented with suppression comments
3. Production build has zero warnings
4. Browser console has zero errors or warnings
5. All smoke test features still work after fixes

If no fixes were needed:
1. Document that this plan was skipped (no issues found in smoke test)
</verification>

<success_criteria>
- All breaking changes fixed OR no issues found
- All deprecation warnings fixed or documented OR no warnings present
- Production build clean (zero warnings)
- All features work correctly after fixes
</success_criteria>

<output>
After completion, create `.planning/phases/15-dependency-upgrades-polish/15-05-SUMMARY.md`
</output>
