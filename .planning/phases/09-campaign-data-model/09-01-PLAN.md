---
phase: 09-campaign-data-model
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/campaign.ts
  - src/types/phish.ts
  - src/types/index.ts
autonomous: true

must_haves:
  truths:
    - "Campaign type exists with id, name, description, createdAt fields"
    - "Phish type exists with scheduledDate field for scheduling"
    - "CampaignPhish type exists extending Phish with campaign-specific metadata"
    - "Types export from index.ts for convenient importing"
    - "Types use crypto.randomUUID() pattern for ID generation (documented in comments)"
    - "Date fields use ISO 8601 string format (documented in comments)"
  artifacts:
    - path: "src/types/campaign.ts"
      provides: "Campaign entity type definition"
      exports: ["Campaign", "CampaignPhish"]
      min_lines: 30
    - path: "src/types/phish.ts"
      provides: "Phish type with scheduledDate field"
      exports: ["Phish", "PhishInput"]
      min_lines: 40
    - path: "src/types/index.ts"
      provides: "Central type exports"
      exports: ["Campaign", "Phish", "CampaignPhish"]
      contains: "export.*Campaign"
  key_links:
    - from: "src/types/campaign.ts"
      to: "src/types/phish.ts"
      via: "import Phish"
      pattern: "import.*Phish.*from.*phish"
    - from: "src/types/campaign.ts"
      to: "src/types/annotations.ts"
      via: "import Annotation"
      pattern: "import.*Annotation.*from.*annotations"
    - from: "src/types/phish.ts"
      to: "src/types/project.ts"
      via: "import ProjectMetadata"
      pattern: "import.*ProjectMetadata.*from.*project"
---

<objective>
Campaign and Phish type definitions for campaign data model foundation.

Purpose: Establish TypeScript types that define the shape of campaign entities and phishing exercises (phishes), enabling type-safe development of campaign features. The Phish type extends project metadata with annotation data, and CampaignPhish adds per-phish scheduling capability.
Output: Complete type definitions in src/types/campaign.ts and src/types/phish.ts with proper exports from index.ts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/09-campaign-data-model/09-CONTEXT.md
@.planning/phases/09-campaign-data-model/09-RESEARCH.md

@src/types/annotations.ts
@src/types/project.ts
@src/types/library.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Phish type definition with scheduledDate</name>
  <files>src/types/phish.ts</files>
  <action>
    Create src/types/phish.ts with the Phish type definition:

    ```typescript
    /**
     * Phish type definitions for Phish Monger
     *
     * A "Phish" represents a single phishing exercise - an email with annotations,
     * scoring data, and optional scheduling information. Phishes can exist in
     * two contexts:
     * 1. Library: Standalone projects in the user's project library
     * 2. Campaign: Copies embedded within a Campaign entity
     */

    import type { ProjectMetadata } from './project';
    import type { Annotation } from './annotations';
    import type { ScoringData } from './scoring';
    import type { InputMode } from '../components/ModeToggle';

    /**
     * A single phishing exercise
     *
     * Combines project metadata, email content, annotations, and scoring
     * into a single portable entity. Phishes can be copied into campaigns
     * while maintaining independence from the source library project.
     *
     * ID generation: Use crypto.randomUUID() - no manual UUID construction
     * Date format: ISO 8601 strings (new Date().toISOString())
     */
    export interface Phish {
      /** Unique identifier (use crypto.randomUUID()) */
      id: string;

      /** Project metadata (title, author, timestamps) */
      metadata: ProjectMetadata;

      /** HTML email source with lure mark spans */
      htmlSource: string;

      /** Annotation data keyed by lure ID */
      annotations: Record<string, Annotation>;

      /** NIST Phish Scale scoring data */
      scoring: ScoringData;

      /** Current input mode (html or richtext) */
      inputMode: InputMode;

      /** Optional scheduled date for campaign phish (ISO 8601 string) */
      scheduledDate?: string;
    }

    /**
     * Input type for creating a new Phish
     *
     * Excludes id field (generated on creation) and makes all fields required
     */
    export interface PhishInput {
      metadata: ProjectMetadata;
      htmlSource: string;
      annotations: Record<string, Annotation>;
      scoring: ScoringData;
      inputMode: InputMode;
      scheduledDate?: string;
    }
    ```

    Key decisions from CONTEXT.md:
    - Use crypto.randomUUID() for ID generation (not uuid package - native browser API)
    - Use ISO 8601 strings for dates (not Date objects)
    - scheduledDate is optional (only set when phish is scheduled in a campaign)

    DO NOT add back-reference to origin project - copies are fully independent per CONTEXT.md decision.
  </action>
  <verify>test -f src/types/phish.ts && grep -q "export interface Phish" src/types/phish.ts && grep -q "scheduledDate" src/types/phish.ts</verify>
  <done>Phish type created with id, metadata, htmlSource, annotations, scoring, inputMode, and optional scheduledDate fields</done>
</task>

<task type="auto">
  <name>Task 2: Create Campaign and CampaignPhish type definitions</name>
  <files>src/types/campaign.ts</files>
  <action>
    Create src/types/campaign.ts with the Campaign type definition:

    ```typescript
    /**
     * Campaign type definitions for Phish Monger
     *
     * Campaigns organize multiple phishing exercises into a collection for
     * scheduled training campaigns. Campaigns are self-contained entities
     * that embed copied phish data for portability.
     */

    import type { Phish } from './phish';

    /**
     * A campaign containing copied phish data
     *
     * Campaigns are fully importable/exportable - they contain copies of
     * phish data rather than references to library projects. This design
     * enables:
     * - Single-file campaign export/import
     * - Independent phish editing within campaigns
     * - No referential integrity concerns when library projects are deleted
     *
     * Per CONTEXT.md: Keep original UUIDs when copying phishes to campaigns.
     * No back-reference to origin project - copies are truly independent.
     */
    export interface Campaign {
      /** Unique identifier (use crypto.randomUUID()) */
      id: string;

      /** Campaign name */
      name: string;

      /** Campaign description */
      description: string;

      /** ISO 8601 timestamp when campaign was created */
      createdAt: string;

      /**
       * Copied phishes embedded in campaign
       *
       * Each CampaignPhish extends the base Phish with campaign-specific
       * scheduling metadata. Phishes are copied from library projects when
       * added to campaigns, maintaining original UUIDs.
       */
      campaignPhishes: CampaignPhish[];
    }

    /**
     * A phish within a campaign
     *
     * Extends base Phish with campaign-specific scheduling. Phishes are
     * deep-copied from library projects, so edits within a campaign don't
     * affect the source.
     */
    export interface CampaignPhish extends Phish {
      /**
       * Scheduled date for this phish within the campaign
       *
       * ISO 8601 date string (e.g., "2026-03-15") for calendar integration.
       * Optional - phishes can be added to campaign without scheduling.
       */
      scheduledDate?: string;
    }

    /**
     * Input type for creating a new Campaign
     *
     * Excludes id and createdAt (generated on creation)
     */
    export interface CampaignInput {
      name: string;
      description: string;
      campaignPhishes: CampaignPhish[];
    }
    ```

    Key decisions from CONTEXT.md:
    - Campaigns are self-contained with copied data (not references)
    - CampaignPhish extends Phish with scheduledDate
    - Use crypto.randomUUID() for ID generation
    - Use ISO 8601 strings for dates

    DO NOT add projectIds array - campaigns contain copied phishes, not references per CONTEXT.md decision.
  </action>
  <verify>test -f src/types/campaign.ts && grep -q "export interface Campaign" src/types/campaign.ts && grep -q "CampaignPhish" src/types/campaign.ts</verify>
  <done>Campaign and CampaignPhish types created with proper structure for self-contained campaign data</done>
</task>

<task type="auto">
  <name>Task 3: Export new types from index.ts</name>
  <files>src/types/index.ts</files>
  <action>
    Update src/types/index.ts to export the new campaign and phish types.

    If src/types/index.ts doesn't exist, create it with all exports:
    ```typescript
    export * from './annotations';
    export * from './library';
    export * from './project';
    export * from './scoring';
    export * from './campaign';
    export * from './phish';
    ```

    If src/types/index.ts exists, add these lines:
    ```typescript
    export * from './campaign';
    export * from './phish';
    ```

    This enables convenient importing like:
    ```typescript
    import { Campaign, Phish, CampaignPhish } from '@/types'
    ```
  </action>
  <verify>grep -q "from './campaign'" src/types/index.ts && grep -q "from './phish'" src/types/index.ts</verify>
  <done>Campaign and Phish types exported from index.ts for convenient importing</done>
</task>

</tasks>

<verification>
1. Check that src/types/campaign.ts exists and exports Campaign, CampaignPhish, CampaignInput
2. Check that src/types/phish.ts exists and exports Phish, PhishInput
3. Check that both files use crypto.randomUUID() pattern in comments
4. Check that date fields are documented as ISO 8601 strings
5. Verify TypeScript compiles without errors: npm run type-check (if available) or npx tsc --noEmit
</verification>

<success_criteria>
- Campaign type exists with id, name, description, createdAt, campaignPhishes fields
- CampaignPhish type extends Phish with optional scheduledDate
- Phish type exists with all required fields and optional scheduledDate
- All types exported from index.ts for convenient importing
- Types are ready for use in useCampaigns hook (Plan 09-03)
</success_criteria>

<output>
After completion, create `.planning/phases/09-campaign-data-model/09-01-SUMMARY.md`
</output>
