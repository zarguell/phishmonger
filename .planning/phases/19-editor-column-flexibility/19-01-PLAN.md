---
phase: 19-editor-column-flexibility
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/columns.ts
  - src/utils/storage.ts
  - src/App.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can click expand button in column header to focus that column (full-width)"
    - "User can click minimize button in column header to collapse column to header bar"
    - "Expand/minimize buttons appear in all 4 column headers (input, preview, lure-list, scoring)"
    - "Column state type definitions exist for TypeScript type safety"
    - "Column header buttons are visible and clickable"
  artifacts:
    - path: "src/types/columns.ts"
      provides: "ColumnID, ColumnState, ColumnStates type definitions"
      contains: "export type ColumnID = 'input' | 'preview' | 'lure-list' | 'scoring'"
    - path: "src/utils/storage.ts"
      provides: "loadColumnStates(), saveColumnStates() functions"
      exports: ["loadColumnStates", "saveColumnStates"]
    - path: "src/App.tsx"
      provides: "Column state management with useState and toggleColumnFocus function"
      contains: "useState<ColumnStates>"
  key_links:
    - from: "src/App.tsx"
      to: "src/utils/storage.ts"
      via: "import { loadColumnStates, saveColumnStates }"
      pattern: "import.*loadColumnStates.*from.*storage"
    - from: "src/App.tsx"
      to: "src/types/columns.ts"
      via: "import type { ColumnID, ColumnStates }"
      pattern: "import type.*ColumnID"
---

<objective>
Create type definitions and storage utilities for column state management, plus implement column header buttons with expand/minimize functionality in App.tsx.

Purpose: Establish the foundation for column flexibility by defining types, storage utilities, and UI controls for column state changes.
Output: Working expand/minimize buttons in all 4 column headers that trigger state changes.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-editor-column-flexibility/19-RESEARCH.md
@src/types/columns.ts
@src/utils/storage.ts
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Create column type definitions</name>
  <files>src/types/columns.ts</files>
  <action>
    Create src/types/columns.ts with:

    1. ColumnID union type: 'input' | 'preview' | 'lure-list' | 'scoring'
    2. ColumnState type: 'expanded' | 'minimized'
    3. ColumnStates record type: Record<ColumnID, ColumnState>
    4. DEFAULT_COLUMN_STATES constant with all columns set to 'expanded'
    5. Export all types

    Follow research pattern exactly (RESEARCH.md lines 73-88).
    Do NOT create any other files in this task.
  </action>
  <verify>grep -q "export type ColumnID" src/types/columns.ts && grep -q "export type ColumnState" src/types/columns.ts && grep -q "export type ColumnStates" src/types/columns.ts</verify>
  <done>Type definitions file exists with all required exports (ColumnID, ColumnState, ColumnStates, DEFAULT_COLUMN_STATES)</done>
</task>

<task type="auto">
  <name>Add column state storage utilities</name>
  <files>src/utils/storage.ts</files>
  <action>
    Add to src/utils/storage.ts (after line 289, before campaign storage section):

    1. COLUMN_STATES_KEY = 'phishmonger-column-states'
    2. loadColumnStates() function that:
       - Reads from localStorage using COLUMN_STATES_KEY
       - Parses JSON and merges with DEFAULT_COLUMN_STATES
       - Returns DEFAULT_COLUMN_STATES on error (try-catch with console.error)
    3. saveColumnStates(states) function that:
       - Stringifies states and saves to localStorage
       - Handles QuotaExceededError gracefully (console.error, no throw)

    Follow existing storage.ts pattern (lines 262-289 for loadCompactLayout/saveCompactLayout).
    Import DEFAULT_COLUMN_STATES from '../types/columns' at top of file.
  </action>
  <verify>grep -q "COLUMN_STATES_KEY" src/utils/storage.ts && grep -q "loadColumnStates" src/utils/storage.ts && grep -q "saveColumnStates" src/utils/storage.ts</verify>
  <done>Storage utilities exist and follow Phase 16 error-handling pattern</done>
</task>

<task type="auto">
  <name>Add column state management and header buttons to App.tsx</name>
  <files>src/App.tsx</files>
  <action>
    Modify src/App.tsx:

    1. Add imports at top (after line 31):
       - import type { ColumnID, ColumnStates } from './types/columns'
       - import { loadColumnStates, saveColumnStates } from './utils/storage'

    2. Add state after line 162 (after arrowStyle state):
       ```typescript
       const [columnStates, setColumnStates] = useState<ColumnStates>(() => loadColumnStates())
       const [focusedColumn, setFocusedColumn] = useState<ColumnID | null>(null)
       ```

    3. Add useEffect after line 197 (after showBadge useEffect):
       ```typescript
       useEffect(() => {
         saveColumnStates(columnStates)
       }, [columnStates])
       ```

    4. Add toggleColumnFocus function after handleViewCarousel (after line 453):
       ```typescript
       const toggleColumnFocus = (columnId: ColumnID) => {
         setFocusedColumn(prev => {
           if (prev === columnId) {
             return null // Reset to normal view
           }
           return columnId // Focus this column
         })
       }
       ```

    5. Add expandColumn/minimizeColumn functions after toggleColumnFocus:
       ```typescript
       const expandColumn = (columnId: ColumnID) => {
         toggleColumnFocus(columnId)
       }

       const minimizeColumn = (columnId: ColumnID) => {
         setColumnStates(prev => ({
           ...prev,
           [columnId]: 'minimized'
         }))
       }
       ```

    6. Add ColumnHeader component inside App (before main return, after line 535):
       ```typescript
       const ColumnHeader = ({ title, columnId, onExpand, onMinimize }: {
         title: string
         columnId: ColumnID
         onExpand: () => void
         onMinimize: () => void
       }) => (
         <div className="column-header">
           <span className="column-header-title">{title}</span>
           <div className="expand-minimize-buttons">
             <button
               className="expand-minimize-btn"
               onClick={onExpand}
               title="Expand to full width"
               type="button"
             >
               +
             </button>
             <button
               className="expand-minimize-btn"
               onClick={onMinimize}
               title="Minimize column"
               type="button"
             >
               -
             </button>
           </div>
         </div>
       )
       ```

    7. Wrap each column content with ColumnHeader:
       - input-column: Add header with "Email Input", expand/minimize buttons
       - preview-column: Add header with "Preview", expand/minimize buttons
       - lure-list-column: Add header with "Annotations", expand/minimize buttons
       - scoring-column: Add header with "Scoring", expand/minimize buttons

    IMPORTANT: Do NOT add keyboard shortcuts (1,2,3,4) in this plan - that's plan 19-04.
    IMPORTANT: Do NOT add CSS styles - that's handled by existing CSS in index.css (next plan).
  </action>
  <verify>grep -q "ColumnID" src/App.tsx && grep -q "toggleColumnFocus" src/App.tsx && grep -q "ColumnHeader" src/App.tsx</verify>
  <done>App.tsx has column state management, toggle functions, and ColumnHeader component with expand/minimize buttons for all 4 columns</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: npm run type-check (or npx tsc --noEmit)
2. Column types exist: grep -q "ColumnID" src/types/columns.ts
3. Storage utilities exist: grep -q "loadColumnStates" src/utils/storage.ts
4. Column headers render in browser (manual visual check - buttons visible in all 4 columns)
</verification>

<success_criteria>
1. Column type definitions file exists with proper TypeScript exports
2. Storage utilities follow Phase 16 error-handling pattern
3. App.tsx manages column state with useState and persists via useEffect
4. All 4 columns have expand (+) and minimize (-) buttons in headers
5. Clicking buttons updates state (visible in React DevTools or localStorage)
</success_criteria>

<output>
After completion, create `.planning/phases/19-editor-column-flexibility/19-01-SUMMARY.md`
</output>
