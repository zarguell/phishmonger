---
phase: 15-dependency-upgrades-polish
plan: 04
type: execute
wave: 4
depends_on: [15-01, 15-02, 15-03]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Annotation creation workflow works (add lure, add technique explanation)"
    - "Visualizer rendering works (badges overlay, explanation cards)"
    - "PNG export works (html2canvas screenshot)"
    - "JSON save/load works (LocalStorage persistence)"
    - "Undo/redo works (Ctrl+Z / Cmd+Z)"
    - "Campaign features work (create, edit, import, export)"
    - "Zero console errors in development mode"
    - "Zero console errors in production build"
  artifacts:
    - path: "src/components/**/*.tsx"
      provides: "All UI components"
      contains: "functional components with hooks"
    - path: "src/extensions/LureMark.ts"
      provides: "Tiptap extension for lure marks"
      contains: "Node.create"
  key_links:
    - from: "Dev server console"
      to: "Zero errors/warnings"
      via: "Browser console inspection"
      pattern: "console.(error|warn)"
    - from: "Production build"
      to: "Zero errors/warnings"
      via: "npm run build && npm run preview"
      pattern: "dist/index.html"
---

<objective>
Comprehensive regression testing of all v1.0-v1.2 features after dependency upgrades.

Purpose: Per CONTEXT.md decision: "Smoke test only - if it works, ship it." Test core workflows that users actually do, not exhaustive edge cases.
Output: Verified working application with all features functional.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/15-dependency-upgrades-polish/15-RESEARCH.md
@.planning/phases/15-dependency-upgrades-polish/15-CONTEXT.md
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/components/**/*.tsx
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete application with all dependencies upgraded (Tiptap v3, React 19, types v11, plugin-react v5)</what-built>
  <how-to-verify>
    **Smoke Test Checklist - Core Workflows**

    1. **Start dev server:**
       npm run dev
       Open http://localhost:5173
       Check browser console (F12) - should be zero errors/warnings

    2. **Annotation workflow (v1.0):**
       - Type text in email content editor
       - Click "Add Lure" button
       - Verify lure badge appears in editor
       - Add technique from library
       - Add explanation text
       - Verify annotation card appears

    3. **Visualizer workflow (v1.0):**
       - Switch to preview mode
       - Verify numbered badge overlay on email
       - Verify technique explanation cards display
       - Toggle badge visibility
       - Switch layout templates (Balanced/Compact/Wide)

    4. **Export workflow (v1.0):**
       - Click "Export PNG" button
       - Verify PNG downloads
       - Click "Export JSON" button
       - Verify JSON downloads

    5. **Persistence workflow (v1.0):**
       - Reload page
       - Verify annotations persist
       - Import a JSON file
       - Verify data loads correctly

    6. **Undo/redo workflow (v1.1):**
       - Make several changes
       - Press Ctrl+Z (or Cmd+Z on Mac)
       - Verify undo works
       - Press Ctrl+Y (or Cmd+Shift+Z)
       - Verify redo works

    7. **Campaign workflow (v1.2):**
       - Click "Campaigns" button
       - Create new campaign
       - Add current phish to campaign
       - Set scheduled date
       - Export campaign JSON
       - Import campaign JSON
       - Export iCal calendar
       - View carousel
       - Toggle compact annotations

    8. **Production build:**
       - Run: npm run build
       - Run: npm run preview
       - Open http://localhost:4173
       - Check browser console - should be zero errors/warnings
       - Test core workflows (annotation, visualizer, export)

    **Pass criteria:** All workflows work, zero console errors or warnings in both dev and production.
  </how-to-verify>
  <resume-signal>Type "approved" if all smoke tests pass, or describe any failures</resume-signal>
</task>

</tasks>

<verification>
After completing the checkpoint:
1. All v1.0 workflows work (annotation, visualizer, export, persistence)
2. All v1.1 workflows work (undo/redo, custom techniques)
3. All v1.2 workflows work (campaigns, carousel, iCal export)
4. Zero console errors in development mode
5. Zero console errors in production build
</verification>

<success_criteria>
- All core features verified working via smoke test
- Zero console errors or warnings in dev or production
- Application ready for v1.2 completion
</success_criteria>

<output>
After completion, create `.planning/phases/15-dependency-upgrades-polish/15-04-SUMMARY.md`
</output>
